** daemon

*** 概述

daemon 的特征：

1. 生命周期较长；
2. 在后台运行且不拥有终端，内核不会为其自动生成任务控制以及终端相关的信号；

*** 创建 daemon

1. fork() 子进程，并把父进程退出。
2. 子进程调用 setsid() 开启新会话并释放与控制终端之间的关系。
3. 如果 daemon 要打开终端，需要特别的处理。
4. 清除进程的 umask 确保创建文件和文件夹时的权限。
5. 修改进程当前工作目录。
6. 关闭父进程打开的文件描述符。
7. 关闭文件描述符0、1和2之后，使用 dup2() 将0、1和2指向 /dev/null。

*** 编写 daemon 指南

几个点：

1. 如何终止一个 daemon 以及终止 daemon 之前的清理工作；
2. 内存泄漏/文件描述符泄露;
3. 可能要保证只有一个实例在跑；

*** SIGHUP 重新初始化 daemon

*** syslog


