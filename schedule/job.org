* job

  Records every day work plan

** WAITING cerberus

*** TODO 资源状态的检查

*** 接入 cashier

** IN-PROGRESS fix simulator

*** DONE panic 后自动回复
    CLOSED: [2019-10-21 一 19:40]

*** DONE ensure all field in exec report
    CLOSED: [2019-10-16 三 18:02]

**** DONE orderID    
     CLOSED: [2019-10-16 三 15:22]

**** clOrderID

**** DONE execID
     CLOSED: [2019-10-16 三 15:22]

**** DONE execType
     CLOSED: [2019-10-16 三 15:22]

**** DONE ordStatus
     CLOSED: [2019-10-16 三 15:22]

**** DONE ordType
     CLOSED: [2019-10-16 三 15:27]

**** DONE lastShares
     CLOSED: [2019-10-16 三 15:23]

**** DONE lastPx
     CLOSED: [2019-10-16 三 15:28]

**** DONE leavesQty
     CLOSED: [2019-10-16 三 15:24]

**** DONE cumQty
     CLOSED: [2019-10-16 三 15:27]

**** DONE averagePx
     CLOSED: [2019-10-16 三 15:27]

*** DONE 重新设计 order 对象
    CLOSED: [2019-10-19 六 16:08]

**** DONE 增加 field    
     CLOSED: [2019-10-17 四 09:56]

     1. OrderQty
     2. AvgPx
     3. CumQty 累计成交
     4. LeavesQty 剩余未成交就用 QrderQty 跟 CumQty 计算吧

**** DONE 将 orderManager 改成一个单例
     CLOSED: [2019-10-17 四 15:35]

     这样子会变得非常尴尬，因为 script 也涉及了 db 的设置。

     将 dbConfig 放到 Config 里面。

     model 模块自己初始化 model 并根据 isMock 初始化实例（决定是 mock 还是 db）。

     scriptModel 也需要这种重构，但是现在只能先搁下了。


**** DONE order 状态变化
     CLOSED: [2019-10-17 四 18:43]

     我们现在有一个 OrderStatus 的转换表。以及对应的优先级表。但是真的好难抽象啊。

***** filled

      1. reject 发送一个 rejected 的 exec report；
      2. New -> Partial Fill -> Fill （当然可能直接变成 fill）；

***** Part-filled order done for day

      1. Partial File -> Done For Day；

***** Cancel a zero-filled order

      1. 如果拒绝，那么发送 cancel reject；
      2. New -> Pending Cancel -> Canceled
      3. ClOrderId 会改变

***** Cancel part-filled order executions while cancel request is active

      重点是：execution 依然可以执行，但是状态应该是 Pending Cancel 。

***** Order become filled before a cancel is accepted

      这时候，应该发送 Cancel Reject, 并令 CxlRejectReason = 0 。


***** cancel/replace request increase order qty (zero-filled)

      改 OrderQty 并改状态为 replace，改 ClOrdId。

***** cancel/replace request increase order qty (part-filled)

      Partial filled 的状态比 Pending replace 高。




**** DONE order 不需要暴露 save 操作，应该在发送 report 的时候处理
     CLOSED: [2019-10-17 四 18:43]

     钻了牛角尖了，filled 的时候 ClOrdId 没有变，用 ClOrdId 查就可以了。

**** DONE 修改 model 定义
     CLOSED: [2019-10-18 五 18:39]

     symbol 和 side 应该往 model 里面写，因为它们可能用来做筛选条件，但是 cumQty 之类的就不必了。 orderQty 也需要保存，因为可能会变动。

     可以自动生成。

**** DONE 过来的 msg 里面的 price 要怎么设置
     CLOSED: [2019-10-19 六 16:02]

     limit 订单的时候需要使用 price，需要使用 price。

**** DONE 写新文档
     CLOSED: [2019-10-21 一 11:04]

**** DONE 发送 new report
     CLOSED: [2019-10-21 一 11:31]

*** TODO 将 scriptManagement 改成单例

*** DONE bug fix: 匹配到了已经删除的 script
    CLOSED: [2019-10-21 一 19:40]

    这有尴尬，因为匹配的时候只看 SessionId 和 MsgType。




